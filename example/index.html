<html>
<head>
    <title>Ratatoskr Example</title>
    <link rel="stylesheet" type="text/css" href="index.css">
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
    <script type="text/javascript" src="../dist/ratatoskr.js"></script>
</head>
<body>
    <label>Endpoint:<input type="text" id="endpoint" value="ws://192.168.1.105:8001"></input></label><br />
    <label>Authorization:<input type="text" id="authorization" value="Session"></input></label><br />
    <label>Agent:<input type="text" id="agent"></input></label><br />
    <label>Resource:<input type="text" id="resource"></input></label>
    <hr />
    <button id="connect">Connect</button>&nbsp;<button id="disconnect">Disconnect</button>
    <hr />
    <input type="text" id="message"></input>
    <button id="send">Send</button>
</body>
<script>
$(function() {
    var client = new Ratatoskr.Client({
        extensions: [
            Ratatoskr.resume({ping: 5*1000, retry: 2})
        ]
    });

    client.on('connected', function() {
        console.log('connected');
    });

    client.on('authenticated', function() {
        console.log('authenticated');
    });

    client.on('disconnected', function(reason) {
        console.log('disconnected', reason);
    });

    client.on('transport:close', function(reason) {
        console.log('transport:close', reason);
    });

    client.on('transport:error', function(reason) {
        console.log('transport:error', reason);
    });

    client.on('chat', function(msg) {
        console.log('chat', msg);
    });

    client.on('presence_change', function(msg) {
        console.log('presence', msg);
    });

    client.on('resume:ping', function(msg) {
        console.log('resume:ping', msg);
    });

    client.on('resume:pong', function(msg) {
        console.log('resume:pong', msg);
    });

    client.on('resume', function(delay, attempts) {
        console.log('resume', delay, attempts);
    });

    client.on('resume:quit', function() {
        console.log('resume:quit');
    });

    client.on('resume:stop', function() {
        console.log('resume:stop');
    });

    $('#connect').on('click', function(evt) {
        var endpoint = $('#endpoint').val(),
            authorization = $('#authorization').val(),
            agent = $('#agent').val(),
            resource = $('#resource').val();

        client.endpoint = endpoint;
        client.authorization = authorization;

        if (agent) {
            client.agent = agent;
        }
        if (resource) {
            client.resource = resource;
        }

        client.connect();
    });

    $('#disconnect').on('click', function(evt) {
        client.disconnect();
    });
});
</script>
</html>
